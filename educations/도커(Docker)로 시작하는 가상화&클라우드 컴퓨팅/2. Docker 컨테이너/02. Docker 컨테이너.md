# Docker 컨테이너

## 도커 이미지

### 도커 이미지 개요

*이미지*

- 컨테이너 실행에 필요한 파일과 설정값 등을 포함하고 있는 것으로 상태값을 가지지 안혹 변하지 않음

*컨테이너*

- 이미지를 실행한 상태라고 볼 수 있고 추가되거나 변하는 값은 컨테이너에 저장됨

> 같은 이미지에서 여러 갱의 컨테이너를 생성할 수 있고 컨테이너의 상태가 바뀌거나 컨테이너가 삭제되더라도 이미지는 변하지 않고 그대로 남아있음

*Ubuntu 이미지*

- ubuntu를 실행하기 위한 모든 파일을 가지고 있고 MySQL 이미지는 debian을 기반으로 MySQL을 실행하는데 필요한 파일과 실행 명령어, 포트 정보 등을 가지고 있음

*Gitlab 이미지*

- centos를 기반으로 ruby, go, database, redis, gitlab source, nginx 등을 가지고 있음

> 이미지는 컨테이너를 실행하기 위핸 모든 정보를 가지고 있기 때문에 더 이상 의존성 파일을 컴파일하고 이것저것 설치할 필요가 없음

> 새로운 서버가 추가되면 미리 만들어 놓은 이미지를 다운받고 컨테이너를 생성만 하면 됨

> 한 서버에 여러 개의 컨테이너를 실행할 수 있고, 수십, 수백, 수천 대의 서버도 문제 없음

> 도커 이미지는 Docker hub에 등록하거나 Docker Repository 저장소를 직접 만들어 관리할 수 있음

## 도커 컨테이너

### 도커 컨테이너 개요

- 도커는 BSD와 솔라리스와 같은 유닉스 운영체제에서 수십 년간 사용되었던 개념이 현대적으로 재탄생된 최신 개념으로 특정 프로세스를 운영체제의 나머지와 일정 수준 분리해 실행시킬 수 있다는 개념
- 각 애플리케이션과 종속물이 운영체제 리소스의 분리된 세그먼트를 사용하는 방식
- 컨테이너를 훨씬 가볍고 운영체제 커널을 공유하며, 시동이 훨씬 빠르고 운영체제 전체 부팅보다 메모리를 훨씬 적게 차지

### 특징

1. 도커 컨테이너, 분리와 조절 기능 제공

  - 도커 컨테이너는 앱을 서로, 그리고 기반이 되는 시스템으로부터 계속 분리함

2. 이식성을 제공하는 도커 컨테이너

- 도커 컨테이너는 컨테이너 런타임 환경을 지원하는 모든 장치에서 실행
- 애플리케이션을 호스트 운영체제와 연결할 필요가 없음

3. 결합성을 제공하는 도커 컨테이너

- 대부분의 비즈니스 애플리케이션은 웹 서버, 데이터베이스, 인-메모리 캐시 등 하나의 스택으로 구성되는 여러 별개의 구성 요소로 구성됨
- 컨테이너는 이런 조각들을 쉽게 변경할 수 있는 부품으로 구성된 기능 유닛으로 결합한다. 여러 컨테이너가 각 조각들을 제공하며, 독립적으로 유지, 업데이트, 교체, 수정할 수 있음.

4. 오케스트레이션과 스케일링이 쉬운 도커 컨테이너

- 컨테이너는 가볍고, 오버헤드가 거의 없음
  - 특정 시스템에서 더 많이 실행시킬 수 있음
- 여러 시스템에서의 애플리케이션 스케일링, 수요 증가와 리소스 보존을 위한 서비스 증가 및 다운에도 컨테이너를 사용할 수 있음

5. 가상 머신이 아닌 도커 컨테이너

- 가상 머신은 운영체제에서 자신이 인스턴스에서 실행되기 때문에 고수준의 프로세스 분리 기능을 제공함
- 컨테이너는 호스트 운영체제에서 통제된 영역을 사용

## Docker 파일

### Docker 파일 개요

*Docker File*

- Docker Image를 만들기 위한 설정 파일
- 여러 가지 명령어를 토대로 Docker File을 작성하면 설정된 내용대로 Docker Image를 만들 수 있음

### Docker 파일 내용

- Gemfile, Gemfile.lock, app.rb + Dockerfile = Docker Image
- 도커는 이미지를 만들기 위해 Docker File이라는 이미지 빌드용 DSLDomain SpecificLanguage 파일을 사용함
- 단순 텍스트 파일로 일반적으로 소스와 함께 관리함

## Docker VM

### 클라우드 서비스

*On-premise*

- 사용자가 직접 인프라, 플랫폼, 애플리케이션을 관리하는 모델
- 규모 있는 업체라면 직접 IDC를 구축하고, 일반적인 경우 IDC에 공간을 할당 받아 물리서버를 설치하고 하드웨어, 운영체제, 서버 애플리케이션을 모두 관리함

*IaaS*

- AWS EC2
- 가상 서버, 데이터 스토리지 및 호스팅 컴퓨터, 네트워크 등 IT 인프라를 지원해주는 서비스로 하드웨어를 서비스로 제공하는 클라우드 모델
- OS와 애플리케이션을 관리함

*PaaS*

*SaaS*

Virtual Machine과 컨테이너 중에 선택할 수 있는 상황이 올 수 있음

## 정리
도커는 특정 프로세스를 운영체제의 나머지와 일정 수준 분리해 실행시킬 수 있다는 개념으로 도커 컨테이너는 훨씬 가볍고 운영체제 커널을 공유하며, 시동이 훨씬 빠르고 운영체제 전체 부팅보다 메모리를 훨씬 적게 차지한다.
