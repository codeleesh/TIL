# 컨슈머 랙 모니터링 애플리케이션, 카프카 버로우

## 컨슈머 랙을 모니터링 해야 하는 이유?

- 지난 영상 참고

## 카프카 랙

- 토픽의 가장 최신 오프셋과 컨뮤서 오프셋간의 차이
- 카프카 클라이언트 라이브러리를 이용해서 카프카 컨슈머 구현
- 이때 구현한 카프카 컨슈머 객체를 통해 현재 랙 정보 확인 가능
- 랙을 실시간으로 모니터링 하고 싶다면 데이터를 Elasticsearch 또는 InfluxDB와 같은 저장소에 넣은 뒤 Grafana 대쉬보드를 이용해서 확인 가능
- 그러나, 컨슈머 단위에서 랙을 모니터링 한다면 아주 위험하고 운영요소가 많이 들어감
  - why? 컨슈머 상태에 디펜던시 발생
- 카프카의 컨슈머 랙을 효과적으로 모니터링 할 수 있도록 버로우(Burrow) 출시
  - 링크드인에서 개발한 오픈소스

## 버로우(Burrow)

- 컨슈머 랙 모니터링을 도와주는 독립적인 애플리케이션
- 3가지 특징
  - 멀티 카프카 클러스터 지원
    - 대부분 2개 이상의 카프가 클러스터 운영
    - 버로우 1개만 연동하면 모두 모니터링 가능
  - Sliding window를 통한 Consumer의 status 확인
    - 버로우에는 sliding window를 통해서 컨슈머의 status를 `ERROR`, `WARNING`, `OK`로 표현
      - 데이터양이 일시적으로 많아져서 컨슈머 오프셋이 증가되고 있으면 `WARNING`
      - 데이터양이 많아지고 있는데 컨슈머가 데이터를 가져가지 않으면 `ERROR`
  - HTTP api 제4
