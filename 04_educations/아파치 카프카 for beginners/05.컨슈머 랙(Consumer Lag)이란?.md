# 컨슈머 랙(Consumer Lag)이란?

- 중요한 모니터링 지표
- 카프카 프로듀서는 토픽의 파티션에 데이터를 쌓음
- 파티션이 1개인 토픽에 프로듀서가 데이터를 넣을 경우
  - 0부터 차례대로 숫자가 매겨지게 됨
  - 프로듀서는 계속 데이터를 넣게 되고
  - 컨뮤서는 계속 데이터를 가져가게 되고
  - 만약 프로듀서가 데이터를 넣어주는 속도가 컨슈머가 가져가는 속도보다 빠르게 되면 어떻게 될까요?
    - 컨슈머가 가져간 데이터의 offset
    - 프로듀서가 넣은 데이터의 offset
    - 이 두개의 offset 간에 차이가 발생
    - 이것은 컨슈머 랙이라고 함
- 주로 컨슈머 상태에 대해 볼때 사용
- 토픽에 여러 파티션이 존재할 경우 여러 컨슈머 랙이 발생할 수 있음
  - 한개의 포틱과 컨슈머 그룹에 대한 lag이 여러개 존재할 수 있을때 그 중 높은 숫자의 lag을 records-lag-max라고함

## 정리

- lag은 프로듀서의 오프셋과 컨슈머의 오프셋간의 차이이다.
- lag은 여러개가 존재할 수 있다.
