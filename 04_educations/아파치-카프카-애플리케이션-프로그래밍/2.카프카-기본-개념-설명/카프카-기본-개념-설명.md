# 카프카 기본 개념 설명

## 카프카 생태계

- 오픈소스 아파치 카프카의 속한 도구이며 자바 라이브러리로 제공
  - 프로듀서
    - 데이터를 넣는 역할, 토픽에 저장됨
  - 컨슈머
    - 토픽에 있는 데이터를 가져감
  - 스트림즈
    - 토픽에 저장된 데이터를 statefull 또는 stateless 하게 데이터를 처리해서 다시 토픽에 넣는 경우
  - 커넥트(싱크, 소스)
    - 소스 커넥트는 프로듀서의 역할, 싱크 커넥트는 컨슈머의 역할
    - 데이터 파이프라인
    - 클러스터

## 카프카 브로커와 클러스터

- 주키퍼
  - 카프카 클러스터를 운영하기 위해서 반드시 필요함
  - 카프카 2.0 버전 까지는 반드시 필요하였으며, 카프카 3.0 버전부터 카프카 클러스터를 운영할때 주키퍼가 없어도 상관없으나 아직까지 완벽하게 대체를 하지 못하기에 주키퍼를 운영하고 있음
- 카프카 클러스터
  - 한 개의 카프카 클러스터는 여러 개의 브로커로 구성
  - 한 개의 브로커는 하나의 피지컬 머신 또는 서버, 인스턴스에서 동작
  - 최소한 상용 환경에서는 3개의 브로커로 운영되는 일반적인 상황
- 카프카 브로커
  - 데이터를 분산 저장하여 장애가 발생하더라도 안전하게 사용할 수 있도록 도와주는 프로세스
  - 하나의 서버에는 하나의 브로커 프로세스가 실행
  - 브로커 서버 한 개로도 기본 기능이 동작하지만, 데이터를 안전하게 처리하기 위해서는 3개 이상의 카프카 클러스터를 묶어서 운영을 해야함

## 브로커의 역할

- 컨트롤러
  - 클러스터의 다수 브로커 중 한 대가 컨트롤러의 역할하면서 분배
- 데이터 삭제
  - 컨슈머가 데이터를 가져가더라도 토픽의 데이터는 삭제되지 않음
- 컨슈머 오프셋 저장
  - 토픽이 특정 파티션으로부터 데이터를 가져가서 처리하고 이 파티션의 어느 레코드까지 가져갔는지 확인하기 위해 오프셋을 커밋
- 그룹 코디네이터
  - 컨슈머 그룹의 상태를 체크하고 파티션을 컨슈머와 매칭되도록 분배하는 역할

## 참고

- 
